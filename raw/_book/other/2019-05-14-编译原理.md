---
type : other
​---
---



## 编译原理

1. 词法分析
2. 语法分析
3. 语义分析
4. 中间代码生成器
5. 代码优化器
6. 代码生成器

### 词法分析

```
position = initial + rate * 60

<id,1> <=> <id,2> <+> <id,3> <*> <60>

<id,1> <=> <id,2> <+> <id,3> <*> <number,4>
```

id 即 identifier，1 指向符号表中对应的条目。生成符号表是非常有必要的，在调试、语义分析等都会用到。

编译将代码转换成了机器码，但是在解决bug时，又需要反过来，这就需要借助符号表。



| 1    | position | ...  |
| ---- | :------- | ---- |
| 2    | initial  | ...  |
| 3    | rate     | ...  |



### 语法分析





### 代码生成器

代码生成器以源程序的中间表示形式作为输入，并把它映射到目标语言。如果目标语言是机器代码，那么久必须为程序使用的每个变量选择寄存器或内存位置。代码生成器的一个至关重要的方面就是合理分配寄存器以存放变量的值。

### 符号表

编译器的重要功能之一是记录源程序中使用的变量的名字，并收集和每个名字的各种属性有关的信息。这些属性可以提供一个名字的存储分配、他的类型、作用于等信息。符号表数据结构为每个变量名字创建了一个记录条目。几率的字段就是名字的各个属性。这个数据结构应该允许编译器迅速查找到每个名字的记录，并想记录中快速存放和获取记录中的数据。

### 参数传递机制

实参和形参主要是通过值调用和引用调用进行关联的。

在值调用中，会对实参求值(如果它是表达式)或者拷贝(如果它是变量)。这些值被放在形参的内存位置上。可以肯定的是形参和实参的地址是不同的。

如果对大型的对象集合等进行拷贝，可能会付出高昂的空间代价，使用引用调用可以。

区分值调用和引用调用，对于编译器优化代码很重要。

```
x = 2

// 如果x是单独的变量，可以优化 a = 5，如果x是引用，不能优化
a = x + 3


```
### 词法分析器

词法分析器在编译器中负责读取源程序，因此它还会完成一些识别词素之外的其他任务。任务之一是过滤掉源程序中的注释和空白；另一个任务是将编译器生成额错误消息和源程序的位置关联起来。如果源程序使用了宏预处理器，则hong
 的扩展也可以由词法分析器完成。

### 运行时刻环境

编译器必须准确地实现源程序语言中包含的各个抽象概念。这些抽象概念通常包括名字、作用域、绑定、数据类型、运算符、过程、参数以及控制流程构造。为了做到这一点，编译器创建并管理一个运行时刻环境，它编译得到的目标程序就运行在这个环境中。这个环境处理很多事物，包括为源程序中命名的对象分配存储位置，确定目标程序访问变量时使用的机制，过程间的链接，参数传递机制，以及操作系统、输入输出设备及其他程序的接口。

从编译器编写者的角度来看，正在执行的目标程序在它自己的逻辑空间内运行，其中每个程序值都在这个空间有一个地址。对这个逻辑地址空间的管理和组织是由编译器、操作系统和目标机共同完成的。操作系统将逻辑地址映射为物理地址，而物理地址对整个内存空间编址。

程序逻辑地址空间分布


1. 代码器
2. 静态区
3. 堆区
4. 空闲内存
5. 栈区

堆和栈都可以向空闲内存发展。

### 活动树 & 活动记录

假如过程调用在时间上不是嵌套的，那么栈式分配就不可行了，可以用树来表示。

活动记录：过程调用和返回通常有一个称为控制栈的运行时刻栈进行管理。每个活跃的活动都有一个位于这个控制栈中活动记录（有时候称为帧）。



 